{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="{% static 'css/air-datepicker.css' %}" type="text/css">
    <title>BarberShop-Appointment</title>
</head>
<body>
    <a href="{% url 'barbershop:barbershop' %}">Главная</a>
    <h3>Записаться к парикмахеру:</h3>
    <h3>{{ step }}</h3>

    {% if step_1 %}
    <form class="row g-3">
        <div class="col-md-4">
            <select class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="barber">
                <option selected>Выберите парикмахера</option>
                {% for barber_name in barber_names %}
                <option value="{{ barber_name }}">{{ barber_name }}</option>
                {% endfor %}
              </select>
        </div>
        <p>Выберите дату:</p>
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <input type="hidden" name="date" id="airdatepicker" class="form-control">
            </div>
        </div>
        <button type="submit">Далее</button>
    </form>


<!--     <form action="{% url 'appointment:appointment' %}" method="GET">
        <p>Выберите дату:</p>

        <input type="date" name="date"
        value={{min_day_value}}
        min={{min_day_value}} max="{{max_day_value}}">

        <p>Выберите парикмахера:</p>

        <select name="barber">
            {% for barber_name in barber_names %}
            <option value="{{ barber_name }}">
                {{ barber_name }}
            </option>
            {% endfor %}
        </select>

        <button type="submit">Далее</button>
    </form> -->
    {% endif %}

    {% if step_2 %}

    <p>Ваш парикмахер: <b>{{ barber }}</b></p>
    <p>{{ message }}</p>

    {% if error_switch %}
    <a href="{% url 'appointment:appointment' %}" type="submit">Выбрать другую дату</a>
    {% else %}
    <form action="{% url 'appointment:thanks_page' %}" method="POST">
        {% csrf_token %}

        <p>Выберите доступное время:</p><br>
        <select name="time">
            {% for time in all_time %}
            <option value="{{ time }}">
                {{ time }}
            </option>
            {% endfor %}
        </select>

        <p>Как будете стричься?</p><br>

        <select name="service">
            {% for service in price_list %}
            <option value="{{ service }}">
                {{ service }}
            </option>
            {% endfor %}
        </select> 

        <p>Введите ваше имя</p><br>
            <input type="text" name="name">       

        <p>Введите ваш номер телефона</p><br>
            <input type="text" value="" name="phone"><br>

        <input type="hidden" name="date"
            value="{{ choised_day }}">

        <input type="hidden" name="barber"  
            value="{{ barber }}">  
            
        <input type="hidden" name="barber_id"  
            value="{{ barber_name.id }}">
        
        <div style="float: left;">
            <a href="{% url 'appointment:appointment' %}" type="submit">Выбрать другую дату</a>
        </div>

        <div style="float: right;">
            <button type="submit">Оставить заявку</button>
        </div>
    </form>
    {% endif %}
    {% endif %}
    <script src="{% static 'js/air-datepicker.js' %}"></script>
    <script>
        let minDate = "{{ min_day_value }}"; 
        let maxDate = "{{ max_day_value }}";

        new AirDatepicker('#airdatepicker', {

            maxDate: new Date(maxDate),
            minDate: new Date(minDate),            
            inline: true,
            isMobile: true,
            autoClose: true,
            // dateFormat: 'dd.mm.yyyy',
            dateFormat: 'yyyy-MM-dd',
        });
    </script>  
</body>
</html>

